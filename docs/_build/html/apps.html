
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Application-specific usage &#8212; SNARTomo  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="SNARTomoClassic" href="classic.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="application-specific-usage">
<h1>Application-specific usage<a class="headerlink" href="#application-specific-usage" title="Permalink to this heading">¶</a></h1>
<p>This section describes usagefor specific applications. Unless noted, the following options are available with both SNARTomoPACE and SNARTomoClassic.</p>
<section id="d-reconstruction">
<h2>3D reconstruction<a class="headerlink" href="#d-reconstruction" title="Permalink to this heading">¶</a></h2>
<p><strong>AreTomo</strong></p>
<p>AreTomo is currently the default, used if you don’t have an eTomo batch directive file (see below).</p>
<p>Starting with AreTomo 1.2, the program now removes dark images by default, with a parameter called “DarkTol”. This parameter (default: 0.7) can be changed with the SNARTomo flag <code class="docutils literal notranslate"><span class="pre">--dark_tol</span></code>.</p>
<p>Another important parameter is the number of patches. During alignment, AreTomo can optionally divide the micrograph into patches. This parameter is set using the flag <code class="docutils literal notranslate"><span class="pre">--are_patches</span></code>. The default is <code class="docutils literal notranslate"><span class="pre">&quot;0</span> <span class="pre">0&quot;</span></code>. To use a 5x5 array of patches, for example, add <code class="docutils literal notranslate"><span class="pre">--are_patches</span> <span class="pre">&quot;5</span> <span class="pre">5&quot;</span></code>. (The quotes around “5 5” are required.) The alignment will be better, but the cost is speed. Without patches, AreTomo takes &lt;2 minutes, whereas with a 5x5 array, AreTomo takes ~30 minutes.</p>
<p><strong>eTomo</strong></p>
<p>This option is for people who prefer the reconstruction from IMOD’s eTomo, and/or would like to refine the reconstruction later on using eTomo.</p>
<p>There are two additional parameters required: <code class="docutils literal notranslate"><span class="pre">--do_etomo</span> <span class="pre">--batch_directive</span> <span class="pre">batch_directive.adoc</span></code></p>
<p>If you provide a batch directive but not the <code class="docutils literal notranslate"><span class="pre">--do_etomo</span></code> flag, SNARTomo will complain, but will still use it.</p>
<p><em>NOTE</em> : Users are responsible for making sure their batch directive files are consistent with their data. Currently, only the pixel size is confirmed.</p>
<p>Someday, we may provide a default batch directive file, but for now, it is a required input.</p>
</section>
<section id="denoising">
<h2>Denoising<a class="headerlink" href="#denoising" title="Permalink to this heading">¶</a></h2>
<p><em>NOTE</em> : Both JANNI and Topaz have been crashing the pre-processing server’s GPUs (both in and outside of SNARTomo), so at the moment, we have limited denoising to the CPU, which takes longer (2-3 seconds per micrograph on the GPU, vs. 17-18 seconds on the CPU).</p>
<p><a class="reference external" href="http://sphire.mpg.de/wiki/doku.php?id=janni">JANNI</a> and <a class="reference external" href="https://github.com/tbepler/topaz">Topaz</a> are two software packages for denoising.</p>
<p><strong>JANNI</strong></p>
<p>To perform denoising in SNARTomo using JANNI, add the <code class="docutils literal notranslate"><span class="pre">--do_janni</span></code> flag.</p>
<p>To see the full set of parameters, add the <code class="docutils literal notranslate"><span class="pre">--help</span></code> flag, or check the SNARTomo web interface.</p>
<p>SNARTomo checks whether the JANNI executable is available (that is, whether it is in your $PATH). If it isn’t in your $PATH, SNARTomo tries to load the JANNI conda environment.</p>
<p><strong>Topaz</strong></p>
<p>For on-the-fly processing, denoising in 2D is currently the only feasible option. Denoising in 3D would be too slow.</p>
<p>To perform denoising in SNARTomo using Topaz, add the <code class="docutils literal notranslate"><span class="pre">--do_topaz</span></code> flag.</p>
<p>One notable parameter is the <code class="docutils literal notranslate"><span class="pre">--topaz_patch</span></code> flag. If not specified, the entire micrograph would be denoised all at once. Even with our 11GB video cards, Topaz complains, so this parameter is set to 2048 by default.</p>
<p>To see the full set of parameters, add the <code class="docutils literal notranslate"><span class="pre">--help</span></code> flag, or check the SNARTomo web interface.</p>
<p>SNARTomo checks whether the Topaz executable is available (that is, whether it is in your $PATH). If it isn’t in your $PATH, SNARTomo tries to load the Topaz conda environment.</p>
</section>
<section id="dose-fitting">
<h2>Dose-fitting<a class="headerlink" href="#dose-fitting" title="Permalink to this heading">¶</a></h2>
<p>This functionality is only available for the PACE version of SNARTomo at the moment.</p>
<p>See the Outputs section below for the color code.</p>
<p>The strategy is adapted from Felix’s idea.  It consists of three steps:</p>
<blockquote>
<div><ul class="simple">
<li><p>Fits the dose rates to a cosine curve (implemented in Python by Tat)</p></li>
<li><p>Removes the points below a threshold dose rate and re-fits</p></li>
<li><p>Removes the points exceeding a threshold residual</p></li>
</ul>
</div></blockquote>
<p>Since the dose can vary considerably, the thresholds are given as a fraction of the maximum dose rate.</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--dosefit_min</span></code> – minimum dose rate allowed (default: 0.10 * maximum dose rate)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--dosefit_resid</span></code> – maximum residual (default: 0.10 * maximum dose rate)</p></li>
</ul>
</div></blockquote>
</section>
<section id="contour-removal">
<h2>Contour-removal<a class="headerlink" href="#contour-removal" title="Permalink to this heading">¶</a></h2>
<p>For eTomo reconstructions, the routine for removing bad contours is called “Ruotnocon” (reverse of “no contour”). Contours are removed on the basis of high residuals. The following is an extreme example:</p>
<p>Ruotnocon is controlled with the following parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--do_ruotnocon</span></code> – True or false (default: false)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--ruotnocon_sd</span></code> – Number of standard deviations for residuals, beyond which contours will be removed (default: 3)</p></li>
</ul>
</div></blockquote>
<p>See the Outputs section for an example of the residual plot.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">SNARTomo</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="framecalc.html">FrameCalc</a></li>
<li class="toctree-l1"><a class="reference internal" href="pace.html">SNARTomoPACE</a></li>
<li class="toctree-l1"><a class="reference internal" href="classic.html">SNARTomoClassic</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Application-specific usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#d-reconstruction">3D reconstruction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#denoising">Denoising</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dose-fitting">Dose-fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="#contour-removal">Contour-removal</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="classic.html" title="previous chapter">SNARTomoClassic</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Tapu Shaikh.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/apps.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>